<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Symmetric Vaccine Efficacy from Fitted Model — sve_from_model • sve</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Symmetric Vaccine Efficacy from Fitted Model — sve_from_model"><meta name="description" content="Computes the symmetric vaccine efficacy (SVE) and associated confidence
intervals from a fitted regression model (Cox, Poisson, etc.) using
the exact likelihood from the model."><meta property="og:description" content="Computes the symmetric vaccine efficacy (SVE) and associated confidence
intervals from a fitted regression model (Cox, Poisson, etc.) using
the exact likelihood from the model."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">sve</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Symmetric Vaccine Efficacy from Fitted Model</h1>

      <div class="d-none name"><code>sve_from_model.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes the symmetric vaccine efficacy (SVE) and associated confidence
intervals from a fitted regression model (Cox, Poisson, etc.) using
the exact likelihood from the model.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sve_from_model</span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  <span class="va">effect_name</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"profile"</span>, <span class="st">"tanh-wald"</span>, <span class="st">"wald"</span><span class="op">)</span>,</span>
<span>  smooth <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  epsilon <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>A fitted model object. Currently supports:</p><ul><li><p><code>coxph</code> objects from the survival package</p></li>
<li><p><code>glm</code> objects with family poisson or binomial</p></li>
</ul></dd>


<dt id="arg-effect-name">effect_name<a class="anchor" aria-label="anchor" href="#arg-effect-name"></a></dt>
<dd><p>Character. Name of the effect variable in the model.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame containing the original data used to fit the model.
Required for profile likelihood method.</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>Confidence level for the interval (default is 0.95).</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Method used to construct the confidence interval.</p>
<p>One of:</p><ul><li><p><code>"profile"</code> (default): Profile likelihood confidence interval using the
exact likelihood from the fitted model.
Requires <code>data</code> argument.</p></li>
<li><p><code>"tanh-wald"</code>: Applies a hyperbolic arctangent
transform before forming the Wald interval, then transforms back.
Uses the variance extracted from the model.</p></li>
<li><p><code>"wald"</code>: Standard Wald interval on the untransformed scale.</p></li>
</ul></dd>


<dt id="arg-smooth">smooth<a class="anchor" aria-label="anchor" href="#arg-smooth"></a></dt>
<dd><p>Logical. Should variance smoothing be applied near the null?
Default is TRUE. Only used for Wald-based methods (<code>wald</code>, <code>tanh-wald</code>).
Ignored for profile likelihood. Recommended to avoid instability when
effect is near 1.</p></dd>


<dt id="arg-epsilon">epsilon<a class="anchor" aria-label="anchor" href="#arg-epsilon"></a></dt>
<dd><p>Numeric. The smoothing window. Only used for Wald-based
methods (<code>wald</code>, <code>tanh-wald</code>) when <code>smooth = TRUE</code>. If <code>NULL</code> and
<code>smooth = TRUE</code>, defaults to \(z_{\alpha/2}
  \sqrt{\hat{p}_0(1-\hat{p}_0)/n_0 + \hat{p}_1(1-\hat{p}_1)/n_1}\)
where \(\hat{p}_0 = x_0/n_0\), \(\hat{p}_1 = x_1/n_1\), and
\(z_{\alpha/2}\) is the critical value from the standard normal
distribution corresponding to the confidence level.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame with the following columns:</p><dl><dt>estimate</dt>
<dd><p>The symmetric vaccine efficacy estimate.</p></dd>

<dt>lower</dt>
<dd><p>Lower bound of the confidence interval.</p></dd>

<dt>upper</dt>
<dd><p>Upper bound of the confidence interval.</p></dd>

<dt>level</dt>
<dd><p>Confidence interval level.</p></dd>

<dt>method</dt>
<dd><p>Indicates the method used for the confidence interval.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function extracts the coefficient and variance for the effect
variable from a fitted model and computes SVE. For the profile likelihood
method, it refits the model with the effect coefficient constrained
to values corresponding to different SVE values, using the exact likelihood
from the original model.</p>
<p>The symmetric vaccine efficacy (SVE) from a relative effect measure is:
$$
\text{SVE} = \frac{1 - \theta}{\max(1, \theta)}
$$
where \(\theta = \exp(\beta)\) is the hazard ratio, relative risk, or
odds ratio from the model.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Cox proportional hazards model</span></span></span>
<span class="r-in"><span><span class="va">fit_cox</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/coxph.html" class="external-link">coxph</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">time</span>, <span class="va">status</span><span class="op">)</span> <span class="op">~</span> <span class="va">vaccination</span> <span class="op">+</span> <span class="va">age</span>,</span></span>
<span class="r-in"><span>                 data <span class="op">=</span> <span class="va">sim_trial_data</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">sve_from_model</span><span class="op">(</span><span class="va">fit_cox</span>, <span class="st">"vaccination"</span>, data <span class="op">=</span> <span class="va">sim_trial_data</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Poisson regression</span></span></span>
<span class="r-in"><span><span class="va">fit_poisson</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">status</span> <span class="op">~</span> <span class="va">vaccination</span> <span class="op">+</span> <span class="va">age</span>,</span></span>
<span class="r-in"><span>                   family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">sim_trial_data</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">sve_from_model</span><span class="op">(</span><span class="va">fit_poisson</span>, <span class="st">"vaccination"</span>, data <span class="op">=</span> <span class="va">sim_trial_data</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Wald methods don't require data</span></span></span>
<span class="r-in"><span><span class="fu">sve_from_model</span><span class="op">(</span><span class="va">fit_cox</span>, <span class="st">"vaccination"</span>, method <span class="op">=</span> <span class="st">"wald"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lucy D’Agostino McGowan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

